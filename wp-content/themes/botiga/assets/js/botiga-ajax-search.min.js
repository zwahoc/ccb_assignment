"use strict";var botiga=botiga||{};botiga.ajaxSearch={ajax:function(e,t,a,n){var r;(r=new XMLHttpRequest).open("POST",botiga.ajaxurl,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onload=function(){200<=this.status&&this.status<400&&n.apply(this)};var o="";a=Object.entries(a);for(var c=0;c<a.length;c++)o+="&"+a[c].join("=");r.send("action="+e+"&nonce="+t+o)},init:function(){var t=this,a=this,n=document.querySelectorAll(".wc-search-field, .wc-block-product-search__field");if(n.length){for(var e=0;e<n.length;e++)!function(e){n[e].setAttribute("autocomplete","off"),n[e].addEventListener("keyup",t.debounce(function(){a.searchFormHandler(n[e])},300)),n[e].addEventListener("focus",t.debounce(function(){a.searchFormHandler(n[e])},300))}(e);document.addEventListener("click",function(e){null===e.target.closest(".botiga-ajax-search__wrapper")&&a.destroy()})}},searchFormHandler:function(a){if(a.value.length<3)return!1;var n=this,e=a.value,t=a.classList,t=t.contains("wc-block-product-search__field")||t.contains("wc-search-field")?"product":"post";n.ajax("botiga_ajax_search_callback",botiga_ajax_search.nonce,{search_term:e,type:t},function(){var e=JSON.parse(this.response),t=a.parentNode.getElementsByClassName("botiga-ajax-search__wrapper")[0];void 0===t&&((t=document.createElement("div")).className="botiga-ajax-search__wrapper",a.parentNode.append(t),a.parentNode.classList.add("botiga-ajax-search")),t.innerHTML=e.output;e=document.querySelector(".botiga-ajax-search-products");null!==e&&n.scrollbarVisible(e)&&e.classList.add("has-scrollbar"),n.elementIsOutOfScreenHorizontal(t)&&t.classList.add("reverse"),window.dispatchEvent(new Event("botiga.ajax.search.results.loaded"))})},destroy:function(){var e=document.querySelectorAll(".botiga-ajax-search__wrapper");if(e.length)for(var t=0;t<e.length;t++)e[t].remove()},debounce:function(n,r){var o=null;return function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];window.clearTimeout(o),o=window.setTimeout(function(){n.apply(null,t)},r)}},scrollbarVisible:function(e){return e.scrollHeight>e.clientHeight},elementIsOutOfScreenHorizontal:function(e){e=e.getBoundingClientRect();return e.x+e.width>window.innerWidth}},jQuery(document).ready(function(){botiga.ajaxSearch.init()});